dplyr::mutate(Parasite_primary = case_when(
primary_infection == "E64" ~ "Eimeria ferrisi",
primary_infection == "E88" ~ "Eimeria falciformis",
primary_infection == "Eflab" ~ "Eimeria falciformis",
primary_infection == "E139" ~ "Eimeria ferrisi",
primary_infection == "UNI" ~ "uninfected",
TRUE ~ ""))
CI <- CI %>%
dplyr::mutate(Parasite_challenge = case_when(
challenge_infection == "E64" ~ "Eimeria ferrisi",
challenge_infection == "E88" ~ "Eimeria falciformis",
challenge_infection == "Eflab" ~ "E. falciformis",
challenge_infection == "E139" ~ "Eimeria ferrisi",
challenge_infection == "UNI" ~ "uninfected",
TRUE ~ ""))
CIMouse_gene <- CI  %>%
dplyr::group_by(EH_ID, infection) %>%
summarise(max_OOC = max(OOC, na.rm = TRUE),
max_WL = min(relative_weight, na.rm = TRUE),
experiment = unique(experiment),
mouse_strain = unique(mouse_strain),
primary_infection = unique(primary_infection),
challenge_infection =unique(challenge_infection),
infection_history=unique(infection_history),
infection = unique(infection),
experiment=unique(experiment),
hybrid_status = unique(hybrid_status),
death = unique(death),
Parasite_primary = unique(Parasite_primary),
Parasite_challenge = unique(Parasite_challenge),
#gene expression
IFNy = unique(IFNy),
CXCR3_bio = unique(CXCR3_bio),
IL.6 = unique(IL.6),
IL.10 = unique(IL.10),
IL.13 = unique(IL.13),
IL1RN = unique(IL1RN),
CASP1 = unique(CASP1),
CXCL9 = unique(CXCL9),
IDO1 = unique(IDO1),
IRGM1 = unique(IRGM1),
MPO = unique(MPO),
MUC2 = unique(MUC2),
MUC5AC = unique(MUC5AC),
MYD88 = unique(MYD88),
NCR1 = unique(NCR1),
PRF1 = unique(PRF1),
RETNLB = unique(RETNLB),
SOCS1 = unique(SOCS1),
TICAM1 = unique(TICAM1),
TNF = unique(TNF))
CIMouse_facs <- CI  %>%
dplyr::group_by(EH_ID, infection) %>%
filter(Position == "mLN") %>%
summarise(max_OOC = max(OOC, na.rm = TRUE),
max_WL = min(relative_weight, na.rm = TRUE),
experiment = unique(experiment),
mouse_strain = unique(mouse_strain),
primary_infection = unique(primary_infection),
challenge_infection =unique(challenge_infection),
infection_history=unique(infection_history),
infection = unique(infection),
experiment=unique(experiment),
hybrid_status = unique(hybrid_status),
death = unique(death),
Parasite_primary = unique(Parasite_primary),
Parasite_challenge = unique(Parasite_challenge),
#cell counts
Position = unique(Position),
CD4 = unique(CD4),
Treg = unique(Treg),
Div_Treg = unique(Div_Treg),
Treg17 = unique(Treg17),
Th1 = unique(Th1),
Div_Th1 = unique(Div_Th1),
Th17 = unique(Th17),
Div_Th17 = unique(Div_Th17),
CD8 = unique(CD8),
Act_CD8 = unique(Act_CD8),
Div_Act_CD8 = unique(Div_Act_CD8),
IFNy_CD4 = unique(IFNy_CD4),
IFNy_CD8 = unique(IFNy_CD8),
Treg_prop = unique(Treg_prop),
IL17A_CD4 = unique(IL17A_CD4))
CIMouse_gene %>%
group_by(infection) %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse_gene %>%
dplyr::group_by(infection) %>%
drop_na(max_OOC) %>%
dplyr::summarise(Total_mice = length(EH_ID))
CIMouse_gene %>%
dplyr::group_by(infection) %>%
drop_na(max_WL) %>%
dplyr::summarise(Total_mice = length(EH_ID))
#Primary:
CIMouse_gene %>%
dplyr::group_by(infection) %>%
dplyr::summarise(IFNy = length(na.omit(IFNy)),
CXCR3_bio = length(na.omit(CXCR3_bio)),
IL.6 = length(na.omit(IL.6)),
IL.10 = length(na.omit(IL.10)),
IL.13 = length(na.omit(IL.13)),
IL1RN = length(na.omit(IL1RN)),
CASP1 = length(na.omit(CASP1)),
CXCL9 = length(na.omit(CXCL9)),
IDO1 = length(na.omit(IDO1)),
IRGM1 = length(na.omit(IRGM1)),
MPO = length(na.omit(MPO)),
MUC2 = length(na.omit(MUC2)),
MUC5AC = length(na.omit(MUC5AC)),
MYD88 = length(na.omit(MYD88)),
NCR1 = length(na.omit(NCR1)),
PRF1 = length(na.omit(PRF1)),
RETNLB = length(na.omit(RETNLB)),
SOCS1 = length(na.omit(SOCS1)),
TICAM1 = length(na.omit(TICAM1)),
TNF = length(na.omit(TNF)))
CIMouse_facs %>%
dplyr::group_by(infection) %>%
dplyr::summarise(CD4 = length(na.omit(CD4)),
Treg = length(na.omit(Treg)),
Div_Treg = length(na.omit(Div_Treg)),
Treg17 = length(na.omit(Treg17)),
Th1 = length(na.omit(Th1)),
Div_Th1 = length(na.omit(Div_Th1)),
Th17 = length(na.omit(Th17)),
Div_Th17 = length(na.omit(Div_Th17)),
CD8 = length(na.omit(CD8)),
Act_CD8 = length(na.omit(Act_CD8)),
Div_Act_CD8 = length(na.omit(Div_Act_CD8)),
IFNy_CD4 = length(na.omit(IFNy_CD4)),
IFNy_CD8 = length(na.omit(IFNy_CD8)),
Treg_prop = length(na.omit(Treg_prop)),
IL17A_CD4 = length(na.omit(IL17A_CD4)))
#Primary:
CIMouse_gene %>%
dplyr::group_by(infection) %>%
dplyr::summarise(IFNy = length(na.omit(IFNy)),
CXCR3_bio = length(na.omit(CXCR3_bio)),
IL.6 = length(na.omit(IL.6)),
IL.10 = length(na.omit(IL.10)),
IL.13 = length(na.omit(IL.13)),
IL1RN = length(na.omit(IL1RN)),
CASP1 = length(na.omit(CASP1)),
CXCL9 = length(na.omit(CXCL9)),
IDO1 = length(na.omit(IDO1)),
IRGM1 = length(na.omit(IRGM1)),
MPO = length(na.omit(MPO)),
MUC2 = length(na.omit(MUC2)),
MUC5AC = length(na.omit(MUC5AC)),
MYD88 = length(na.omit(MYD88)),
NCR1 = length(na.omit(NCR1)),
PRF1 = length(na.omit(PRF1)),
RETNLB = length(na.omit(RETNLB)),
SOCS1 = length(na.omit(SOCS1)),
TICAM1 = length(na.omit(TICAM1)),
TNF = length(na.omit(TNF)))
knitr::opts_chunk$set(echo = TRUE)
## Load the required libraries
library(dplyr)
library(tidyverse)
library(tibble)
#### Read the file
CI <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data_products/Challenge_infections.csv")
tibble::as_tibble(CI)
CI <- CI %>%
dplyr::mutate(Parasite_primary = case_when(
primary_infection == "E64" ~ "Eimeria ferrisi",
primary_infection == "E88" ~ "Eimeria falciformis",
primary_infection == "Eflab" ~ "Eimeria falciformis",
primary_infection == "E139" ~ "Eimeria ferrisi",
primary_infection == "UNI" ~ "uninfected",
TRUE ~ ""))
CI <- CI %>%
dplyr::mutate(Parasite_challenge = case_when(
challenge_infection == "E64" ~ "Eimeria ferrisi",
challenge_infection == "E88" ~ "Eimeria falciformis",
challenge_infection == "Eflab" ~ "E. falciformis",
challenge_infection == "E139" ~ "Eimeria ferrisi",
challenge_infection == "UNI" ~ "uninfected",
TRUE ~ ""))
CIMouse <- CI  %>%
dplyr::group_by(EH_ID, infection) %>%
summarise(max_OOC = max(OOC, na.rm = TRUE),
max_WL = min(relative_weight, na.rm = TRUE),
experiment = unique(experiment),
mouse_strain = unique(mouse_strain),
primary_infection = unique(primary_infection),
challenge_infection =unique(challenge_infection),
infection_history=unique(infection_history),
infection = unique(infection),
experiment=unique(experiment),
hybrid_status = unique(hybrid_status),
death = unique(death),
Parasite_primary = unique(Parasite_primary),
Parasite_challenge = unique(Parasite_challenge))
CIMouse %>%
group_by(infection) %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
group_by(experiment) %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
group_by(mouse_strain, hybrid_status) %>%
dplyr::summarise(total_mice = length(EH_ID))
#now only show the hybrid status
CIMouse %>%
group_by(hybrid_status) %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
filter(infection == "primary") %>%
group_by(Parasite_primary)  %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
filter(infection == "challenge") %>%
group_by(Parasite_challenge)  %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
group_by(death) %>%
dplyr::summarise(length(EH_ID))
CIMouse %>%
filter(death == "primary", infection == "primary") %>%
group_by(Parasite_primary) %>%
dplyr::summarise(total_mice = length(EH_ID))
CIMouse %>%
filter(infection == "primary")  %>%
ggplot(aes(max_OOC, color = Parasite_primary, fill = Parasite_primary)) +
geom_histogram(bins = 30, alpha = 0.5) +
labs(x = "Oocysts at day of maximal shedding", y = "Number of mice",
title = "Maximum oocyst shedding per mouse, primary infections") +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(x = Parasite_primary, y = max_OOC, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(x = Parasite_primary, y = max_OOC, fill = Parasite_primary)) +
geom_violin() +
theme_bw()
CIMouse  %>%
filter(infection == "primary", !Parasite_primary == "uninfected")  %>%
ggplot(aes(x = Parasite_primary, y = max_OOC, fill = Parasite_primary)) +
geom_violin(alpha = 0.5) +
geom_line() +
stat_summary(fun.y = "median", geom = "point", size = 3) +
theme_bw()
CIMouse  %>%
filter(infection == "primary", !Parasite_primary == "uninfected")  %>%
ggplot(aes(x = Parasite_primary, y = max_OOC, fill = Parasite_primary)) +
geom_violin(alpha = 0.5) +
geom_line() +
stat_summary(fun.y = "median", geom = "point", size = 3) +
theme_bw()
CIMouse %>%
filter(infection == "challenge")  %>%
ggplot(aes(max_OOC, color = Parasite_challenge, fill = Parasite_challenge)) +
geom_histogram(bins = 30, alpha = 0.5) +
labs(x = "Oocysts at day of maximal shedding", y = "Number of mice",
title = "Maximum oocyst shedding per mouse, challenge infections") +
theme_bw()
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(x = Parasite_challenge, y = max_OOC, fill = Parasite_challenge)) +
geom_boxplot() +
theme_bw()
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(x = Parasite_challenge, y = max_OOC, fill = Parasite_challenge)) +
geom_violin() +
theme_bw()
CIMouse  %>%
filter(infection == "challenge", !Parasite_challenge == "uninfected")  %>%
ggplot(aes(x = Parasite_challenge, y = max_OOC, fill = Parasite_challenge)) +
geom_violin(alpha = 0.5) +
geom_line() +
stat_summary(fun.y = "median", geom = "point", size = 3) +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(x = Parasite_primary, y = max_OOC, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ hybrid_status)
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(y = max_OOC, fill = Parasite_challenge)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ hybrid_status)
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(y = max_OOC, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ experiment)
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(y = max_OOC, fill = Parasite_challenge)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ experiment)
CI %>%
group_by("EH_ID") %>%
filter(infection == "primary") %>%
ggplot(aes(x = dpi, y = OOC, color = Parasite_primary)) +
geom_point(position = position_jitterdodge()) +
labs(x = "Days Post Infection", y = "Oocysts per gram",
title = "Oocyst shedding in primary infections during the
course of infection") +
theme_bw()
CI %>%
group_by("EH_ID") %>%
filter(infection == "primary") %>%
ggplot(aes(x = dpi, y = OOC, color = Parasite_primary)) +
geom_point(position = position_jitterdodge()) +
labs(x = "Days Post Infection", y = "Oocysts per gram",
title = "Oocyst shedding in primary infections during the
course of infection") +
theme_bw() +
stat_smooth() +
facet_wrap(~ experiment)
CI %>%
group_by("EH_ID") %>%
filter(infection == "primary") %>%
ggplot(aes(x = dpi, y = OOC, color = Parasite_primary)) +
geom_point(position = position_jitterdodge()) +
labs(x = "Days Post Infection", y = "Oocysts per gram",
title = "Oocyst shedding in primary infections during the
course of infection") +
theme_bw() +
facet_wrap(~ hybrid_status)
CI %>%
group_by("EH_ID") %>%
filter(infection == "challenge") %>%
ggplot(aes(x = dpi, y = OOC, color = Parasite_challenge)) +
geom_point(position = position_jitterdodge()) +
labs(x = "Days Post Infection", y = "Oocysts per gram",
title = "Oocyst shedding in challenge infections during the
course of infection") +
theme_bw() +
facet_wrap(~ experiment)
CI %>%
group_by("EH_ID") %>%
filter(infection == "challenge") %>%
ggplot(aes(x = dpi, y = OOC, color = Parasite_challenge)) +
geom_point(position = position_jitterdodge()) +
labs(x = "Days Post Infection", y = "Oocysts per gram",
title = "Oocyst shedding in challenge infections during the
course of infection") +
theme_bw() +
facet_wrap(~ hybrid_status)
CIMouse %>%
dplyr::filter(infection == "primary") %>%
ggplot(aes(max_WL, color = Parasite_primary, fill = Parasite_primary)) +
geom_histogram(bins = 30, alpha = 0.5)  +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(x = Parasite_primary, y = max_WL, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(x = Parasite_primary, y = max_WL, fill = Parasite_primary)) +
geom_violin(alpha = 0.5) +
geom_line() +
stat_summary(fun.y = "median", geom = "point", size = 3) +
theme_bw()
CIMouse %>%
filter(infection == "challenge")  %>%
ggplot(aes(max_WL, color = Parasite_challenge, fill = Parasite_challenge)) +
geom_histogram(bins = 30, alpha = 0.5) +
theme_bw()
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(x = Parasite_challenge, y = max_WL, fill = Parasite_challenge)) +
geom_boxplot() +
theme_bw()
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(x = Parasite_challenge, y = max_WL, fill = Parasite_challenge)) +
geom_violin(alpha = 0.5) +
geom_line() +
stat_summary(fun.y = "median", geom = "point", size = 3) +
theme_bw()
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(y = max_WL, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ hybrid_status)
CIMouse  %>%
filter(infection == "challenge")  %>%
ggplot(aes(, y = max_WL, fill = Parasite_challenge)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ hybrid_status)
CIMouse  %>%
filter(infection == "primary")  %>%
ggplot(aes(y = max_WL, fill = Parasite_primary)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~ experiment)
CI %>%
filter(infection == "primary") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_primary)) +
geom_jitter() +
stat_smooth() +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the primary infection") +
theme_bw()
CI %>%
filter(infection == "primary") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_primary)) +
geom_jitter() +
stat_smooth() +
facet_wrap(~ mouse_strain) +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the primary infection") +
theme_bw()
CI %>%
filter(infection == "primary") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_primary)) +
geom_jitter() +
stat_smooth() +
facet_wrap(~ experiment) +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the primary infection") +
theme_bw()
CI %>%
filter(infection == "challenge") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_challenge)) +
geom_jitter() +
stat_smooth() +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the challenge infection") +
theme_bw()
CI %>%
filter(infection == "challenge") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_challenge)) +
geom_jitter() +
stat_smooth() +
facet_wrap(~ mouse_strain) +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the challenge infection") +
theme_bw()
CI %>%
filter(infection == "challenge") %>%
drop_na(weight_dpi0, relative_weight) %>%
group_by("EH_ID") %>%
ggplot(aes(x = dpi, y = relative_weight, color = Parasite_challenge)) +
geom_jitter() +
stat_smooth() +
facet_wrap(~ experiment) +
labs(x = "Days Post Infection", y = "Relative weight to first day",
title = "Weight changes during the course of the challenge infection") +
theme_bw()
CI  %>%
group_by("EH_ID") %>%
filter(infection == "primary", Eim_MC == "TRUE") %>%
ggplot(aes(x = delta, y = max_WL, color = Parasite_primary)) +
geom_jitter() +
labs(x = "Delta Ct, Infection intensity", y = "Maximum weight loss of each mouse",
title = "Maximum Weight loss for each mouse and infection intensity,
primary infections") +
geom_smooth(method = "lm") +
theme_bw()
CI  %>%
group_by("EH_ID") %>%
filter(infection == "challenge", Eim_MC == "TRUE") %>%
ggplot(aes(x = delta, y = max_WL, color = Parasite_challenge)) +
geom_jitter() +
labs(x = "Delta Ct, Infection intensity", y = "Maximum weight loss of each mouse",
title = "Maximum Weight loss for each mouse and infection intensity,
challenge infections") +
geom_smooth(method = "lm") +
theme_bw()
CI  %>%
group_by("EH_ID") %>%
filter(infection == "primary", Eim_MC == "TRUE") %>%
ggplot(aes(x = delta, y = max_WL, color = Parasite_primary)) +
geom_jitter() +
labs(x = "Delta Ct, Infection intensity", y = "Maximum weight loss of each mouse",
title = "Maximum Weight loss for each mouse and infection intensity,
primary infections") +
geom_smooth(method = "lm") +
theme_bw() +
facet_wrap(~experiment)
CI  %>%
group_by("EH_ID") %>%
filter(infection == "challenge", Eim_MC == "TRUE") %>%
ggplot(aes(x = delta, y = max_WL, color = Parasite_challenge)) +
geom_jitter() +
labs(x = "Delta Ct, Infection intensity", y = "Maximum weight loss of each mouse",
title = "Maximum Weight loss for each mouse and infection intensity,
challenge infections") +
geom_smooth(method = "lm") +
theme_bw()  +
facet_wrap(~experiment)
