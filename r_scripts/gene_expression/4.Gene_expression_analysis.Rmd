---
title: "4.Gene_expressions_analysis -  Analyzing differences between field and 
lab gene expression data"
author: "Fay Webster"
date: '2022-07-18'
geometry: margin=2cm
output:
  pdf_document: default
  theme: journal
  toc: yes
  toc_float: yes
  html_document: null
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Aims:
- Compare immune gene expression between lab and field data

# load libraries
```{r}
library(ggplot2)
library(tidyverse)
```


# Import data:
Here, we have the experimental / field data, inlcuding imputed data

```{r}
lab <- read.csv("output_data/gene_expression/data_products/lab_imputed_gene_expression.csv")
field <- read.csv("output_data/gene_expression/data_products/field_imputed_gene_expression.csv")
```

# Selecting genes
```{r}
# vectors for selecting gene columns 
Genes_lab <- c("IFNy", "CXCR3_bio", "IL.6", "IL.10", "IL.13", "IL1RN", "CASP1", 
               "CXCL9", "IDO1", "IRGM1", "MPO", "MUC2", "MUC5AC", 
           "MYD88", "NCR1", "PRF1", "RETNLB", "SOCS1", "TICAM1", "TNF")

Genes_field   <- c("IFNy",  "CXCR3", "IL.6", #"GBP2", "IL.12", "IRG6",
                     "IL.10", "IL.13", "IL1RN",
                     "CXCR3", "CASP1", "CXCL9", 
                     "IDO1", "IRGM1", "MPO", "MUC2", "MUC5AC", "MYD88", 
                     "NCR1", "PRF1", "RETNLB", "SOCS1", "TICAM1", "TNF")
```


## 1. IFNy

```{r}
ggplot(lab, aes(x = delta, y = IFNy, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in lab 
       infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IFNy, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```
## 2. CXCR3

```{r}
ggplot(lab, aes(x = delta, y = CXCR3_bio, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", y = "CXCR3",
       title ="Immune gene expression against infection intensity in lab 
       infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = CXCR3, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in 
       field samples") +
  theme_bw()


```

## 3. IL.6

```{r}
ggplot(lab, aes(x = delta, y = IL.6, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity in lab 
       infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IL.6, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()


```

## 4. IL.10

```{r}
ggplot(lab, aes(x = delta, y = IL.10, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IL.10, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()


```



## 5. IL.13

```{r}
ggplot(lab, aes(x = delta, y = IL.13, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IL.13, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()


```

## 6. IL1RN

```{r}
ggplot(lab, aes(x = delta, y = IL1RN, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IL1RN, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 7. CASP1

```{r}
ggplot(lab, aes(x = delta, y = CASP1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = CASP1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```


## 8. CXCL9

```{r}
ggplot(lab, aes(x = delta, y = CXCL9, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = CXCL9, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 9. IDO1

```{r}
ggplot(lab, aes(x = delta, y = IDO1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IDO1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 10. IRGM1

```{r}
ggplot(lab, aes(x = delta, y = IRGM1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = IRGM1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 11. MPO

```{r}
ggplot(lab, aes(x = delta, y = MPO, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = MPO, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```


## 12. MUC2

```{r}
ggplot(lab, aes(x = delta, y = MUC2, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = MUC2, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```


## 13. MUC5AC
```{r}
ggplot(lab, aes(x = delta, y = MUC5AC, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = MUC5AC, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 14. MYD88
```{r}
ggplot(lab, aes(x = delta, y = MYD88, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = MYD88, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 15. NCR1
```{r}
ggplot(lab, aes(x = delta, y = NCR1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = NCR1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```


## 16. PRF1
```{r}
ggplot(lab, aes(x = delta, y = PRF1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = PRF1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 17. RETNLB
```{r}
ggplot(lab, aes(x = delta, y = RETNLB, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = RETNLB, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 18. SOCS1
```{r}
ggplot(lab, aes(x = delta, y = SOCS1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = SOCS1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 19. TICAM1
```{r}
ggplot(lab, aes(x = delta, y = TICAM1, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = TICAM1, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

## 20. TNF
```{r}
ggplot(lab, aes(x = delta, y = TNF, color = Parasite_challenge)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct", 
       title ="Immune gene expression against infection intensity 
       in lab infections") +
  theme_bw()



ggplot(field, aes(x = delta, y = TNF, color = eimeriaSpecies)) +
  geom_jitter() +
  geom_abline() + 
  labs(x = "Infection intensity, dct",
       title ="Immune gene expression against infection intensity in field 
       samples") +
  theme_bw()

```

Results:


- FIeld: IFNy has some peculiar high expression in the samples with low infection intensities, whereas is not expressed at all in highly infected samples.
- Field: same for IL13